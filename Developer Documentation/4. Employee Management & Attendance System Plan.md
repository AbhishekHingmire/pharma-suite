# Employee Management & Attendance System - Implementation Plan

## Research: Pharmaceutical Distribution Employee Roles

Based on industry standards in India and globally, pharmaceutical distributors typically employ:

### **Core Employee Roles**

#### 1. **Sales & Marketing Team**
- **Sales Representatives / Medical Representatives (MR)**
  - Visit doctors, hospitals, pharmacies
  - Generate orders, promote products
  - Track daily visits, meeting reports
  - Commission-based performance tracking

- **Area Sales Manager (ASM)**
  - Supervises 5-10 sales reps
  - Territory management
  - Sales target tracking

- **Sales Coordinator**
  - Process orders from sales team
  - Coordinate with warehouse
  - Customer follow-ups

#### 2. **Warehouse & Logistics**
- **Warehouse Manager**
  - Inventory oversight
  - Stock reconciliation
  - Quality checks for expiry

- **Warehouse Workers / Pickers**
  - Pick & pack orders
  - Loading/unloading
  - Stock arrangement

- **Delivery Executive / Driver**
  - Deliver orders to customers
  - Collect payments (COD)
  - Return management

- **Dispatch Coordinator**
  - Schedule deliveries
  - Route optimization
  - Track shipments

#### 3. **Operations & Administration**
- **Purchase Manager**
  - Vendor negotiations
  - Purchase planning
  - Price tracking

- **Accounts Executive**
  - Payment processing
  - Reconciliation
  - GST filing support

- **Data Entry Operator**
  - Invoice entry
  - Record management
  - Report generation

#### 4. **Quality & Compliance**
- **Quality Control Officer**
  - Batch verification
  - Expiry monitoring
  - Storage condition checks

- **Regulatory Compliance Officer** (optional for larger firms)
  - License renewals
  - Audit compliance

---

## System Design: Employee Management Module

### **Phase 1: Enhanced User/Employee Management**

#### Updated Employee Types
```typescript
type EmployeeRole = 
  | 'admin'                    // Owner/Director
  | 'sales-rep'                // Medical Representative
  | 'sales-manager'            // Area Sales Manager
  | 'sales-coordinator'        // Sales Coordinator
  | 'warehouse-manager'        // Warehouse Manager
  | 'warehouse-worker'         // Picker/Packer
  | 'delivery-executive'       // Driver/Delivery
  | 'dispatch-coordinator'     // Dispatch Coordinator
  | 'purchase-manager'         // Purchase Manager
  | 'accounts-executive'       // Accounts
  | 'data-entry'               // Data Entry Operator
  | 'qc-officer';              // Quality Control

interface Employee extends User {
  id: number;
  name: string;
  mobile: string;
  email?: string;
  role: EmployeeRole;
  status: 'active' | 'inactive' | 'on-leave';
  
  // Employment Details
  employeeCode: string;        // EMP001, EMP002
  joiningDate: string;
  department: 'sales' | 'warehouse' | 'operations' | 'accounts' | 'quality';
  reportingTo?: number;        // Manager's employee ID
  salary?: number;             // Optional, role-based access
  
  // Contact & Personal
  address?: string;
  emergencyContact?: string;
  aadharNo?: string;           // For compliance
  
  // Access Control
  permissions: Permission[];
  
  // Work Schedule
  workingHours: {
    start: string;             // "09:00"
    end: string;               // "18:00"
  };
  weeklyOff: number[];         // [0, 6] = Sunday, Saturday
  
  // Performance
  targets?: {
    type: 'sales' | 'visits' | 'deliveries';
    monthly: number;
    achieved: number;
  };
}
```

---

### **Phase 2: Attendance Management System**

#### Attendance Data Structure
```typescript
interface Attendance {
  id: number;
  employeeId: number;
  date: string;                // "2025-11-21"
  
  // Check-in/Check-out
  checkIn?: string;            // "09:15:00"
  checkOut?: string;           // "18:30:00"
  
  // Status
  status: 'present' | 'absent' | 'half-day' | 'leave' | 'holiday' | 'week-off';
  
  // Leave Details (if applicable)
  leaveType?: 'sick' | 'casual' | 'earned' | 'unpaid';
  leaveReason?: string;
  
  // Work Details
  workHours?: number;          // Calculated hours
  overtime?: number;           // Hours beyond scheduled
  
  // Location (for field staff)
  checkInLocation?: {
    lat: number;
    lng: number;
    address: string;
  };
  checkOutLocation?: {
    lat: number;
    lng: number;
    address: string;
  };
  
  // Approval
  markedBy: 'self' | 'admin' | 'system';
  approvedBy?: number;         // Manager ID
  notes?: string;
}

interface LeaveRequest {
  id: number;
  employeeId: number;
  leaveType: 'sick' | 'casual' | 'earned' | 'unpaid';
  fromDate: string;
  toDate: string;
  days: number;
  reason: string;
  status: 'pending' | 'approved' | 'rejected';
  appliedOn: string;
  approvedBy?: number;
  approvalDate?: string;
  rejectionReason?: string;
}

interface LeaveBalance {
  employeeId: number;
  year: number;
  casual: { total: number; used: number; remaining: number };
  sick: { total: number; used: number; remaining: number };
  earned: { total: number; used: number; remaining: number };
}
```

---

### **Phase 3: Activity Timeline / Task Management**

#### Activity Tracking
```typescript
interface EmployeeActivity {
  id: number;
  employeeId: number;
  date: string;
  timestamp: string;
  
  // Activity Type
  type: 'sale' | 'purchase' | 'delivery' | 'visit' | 'task' | 'meeting' | 'call';
  
  // Activity Details
  title: string;
  description?: string;
  
  // Related Records
  saleId?: number;
  purchaseId?: number;
  customerId?: number;
  
  // For Sales Reps
  visitDetails?: {
    customerName: string;
    customerType: 'doctor' | 'pharmacy' | 'hospital';
    location: { lat: number; lng: number; address: string };
    orderValue?: number;
    feedback?: string;
    nextFollowUp?: string;
  };
  
  // For Delivery
  deliveryDetails?: {
    orderId: number;
    customerName: string;
    deliveryStatus: 'delivered' | 'partial' | 'returned' | 'rescheduled';
    paymentCollected?: number;
    signature?: string;       // Base64 image
  };
  
  // Status
  status: 'completed' | 'pending' | 'in-progress';
  priority?: 'low' | 'medium' | 'high';
  
  // Geolocation
  location?: {
    lat: number;
    lng: number;
    address: string;
  };
  
  // Time Tracking
  startTime?: string;
  endTime?: string;
  duration?: number;          // minutes
  
  // Attachments
  attachments?: string[];     // URLs/Base64
  
  createdAt: string;
}

interface DailyReport {
  id: number;
  employeeId: number;
  date: string;
  
  // Summary
  totalActivities: number;
  completedTasks: number;
  pendingTasks: number;
  
  // Role-specific metrics
  salesMetrics?: {
    visitsCompleted: number;
    ordersGenerated: number;
    orderValue: number;
    newCustomers: number;
  };
  
  deliveryMetrics?: {
    deliveriesCompleted: number;
    cashCollected: number;
    returns: number;
  };
  
  warehouseMetrics?: {
    ordersProcessed: number;
    stockAdjustments: number;
    itemsPicked: number;
  };
  
  // Notes & Feedback
  remarks?: string;
  submittedAt: string;
}
```

---

## UI/UX Design: Feature Breakdown

### **1. Admin Dashboard - Employee Overview**

**New Section: Team Performance**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Team Performance                      Today â–¼       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Present: 12/15     â° On Field: 8    ðŸ  Absent: 3â”‚
â”‚                                                      â”‚
â”‚ Sales Reps:  5 active  |  3 visits completed       â”‚
â”‚ Warehouse:   4 active  |  28 orders packed          â”‚
â”‚ Delivery:    3 active  |  15 deliveries done        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **2. Masters > Employees (Enhanced Users Page)**

**Features**:
- Role-based filtering (Sales, Warehouse, Operations, etc.)
- Quick stats: Total, Active, On Leave, Absent Today
- Bulk actions: Mark attendance, Send notification
- Employee cards with:
  - Profile picture placeholder
  - Role badge
  - Status indicator
  - Last active timestamp
  - Quick actions: View, Edit, Mark Attendance

**New Form Fields**:
- Employee Code (auto-generated)
- Department dropdown
- Reporting Manager (hierarchy)
- Joining Date
- Working Hours (start-end)
- Weekly Off selection
- Target assignment (for sales roles)

---

### **3. Attendance Module (New Page)**

**Path**: `/attendance`

#### **Attendance Dashboard**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Attendance                       Nov 2025 â–¼       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Today: 21 Nov 2025                                â”‚
â”‚                                                    â”‚
â”‚ âœ… Present: 12      âŒ Absent: 2     ðŸ–ï¸ Leave: 1 â”‚
â”‚ â° Late: 3          â³ Half Day: 0   ðŸŽ‰ Holiday: 0â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚ [Mark Attendance] [View Calendar] [Leave Requests]â”‚
â”‚                                                    â”‚
â”‚ Employee List with Today's Status:                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Ramesh Kumar (Sales Rep)        âœ… 09:15 AM â”‚  â”‚
â”‚ â”‚ Check-in: 09:15 | Check-out: -- | On Field  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Priya Sharma (Warehouse)        âœ… 09:00 AM â”‚  â”‚
â”‚ â”‚ Check-in: 09:00 | Check-out: 18:30 | 9.5hrsâ”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Calendar View**
- Monthly calendar with color-coded days
- Green: Full attendance
- Yellow: Partial/Late
- Red: Absent
- Blue: Leave
- Gray: Holiday/Week-off

#### **Leave Management Tab**
- Pending leave requests with approve/reject
- Leave balance overview
- Apply leave (for own account)

---

### **4. Employee Timeline / Activity Log**

**Path**: `/employees/{id}/timeline`

#### **Timeline View**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ramesh Kumar - Activity Timeline                    â”‚
â”‚ [Today] [This Week] [This Month]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Today - 21 Nov 2025                   5 activities  â”‚
â”‚                                                      â”‚
â”‚ ðŸ“ 09:15 AM | Checked In                            â”‚
â”‚    Location: Office, Mumbai                         â”‚
â”‚                                                      â”‚
â”‚ ðŸ¥ 10:30 AM | Customer Visit                        â”‚
â”‚    Dr. Rajesh Clinic, Andheri                       â”‚
â”‚    Order: â‚¹12,500 | Next follow-up: 25 Nov         â”‚
â”‚                                                      â”‚
â”‚ ðŸ“¦ 12:45 PM | Sale Created                          â”‚
â”‚    Invoice #INV-2025-1234 | â‚¹8,900                 â”‚
â”‚                                                      â”‚
â”‚ â˜Žï¸ 02:30 PM | Customer Call                         â”‚
â”‚    Apollo Pharmacy - Order inquiry                  â”‚
â”‚    Duration: 8 mins                                 â”‚
â”‚                                                      â”‚
â”‚ ðŸ¥ 04:00 PM | Customer Visit                        â”‚
â”‚    Max Hospital, Bandra                             â”‚
â”‚    Meeting with procurement team                    â”‚
â”‚                                                      â”‚
â”‚ ðŸ“ 06:30 PM | Checked Out                           â”‚
â”‚    Location: Office, Mumbai | 9.25 hrs worked       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Weekly Summary**
```
Mon  Tue  Wed  Thu  Fri  Sat  Sun
 8    12   10   15   11   --   --  (activities)
âœ“    âœ“    âœ“    âœ“    âœ“    WO   WO  (attendance)
```

---

### **5. Worker Dashboard (Staff View)**

**Enhanced Dashboard for Staff Role**:

#### **Daily Checklist**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ My Day - 21 Nov 2025                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Checked In: 09:15 AM                  â”‚
â”‚ â° Working: 5h 30m                       â”‚
â”‚                                          â”‚
â”‚ [Check Out] [Add Activity] [Daily Report]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Today's Tasks**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ My Tasks                        3 pendingâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ Visit Dr. Sharma Clinic by 11:00 AM   â”‚
â”‚ â–¡ Follow up with Apollo Pharmacy         â”‚
â”‚ âœ“ Submit yesterday's sales report        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Quick Actions** (Role-based)
- **Sales Rep**: Add Visit, Create Sale, Add Call Log
- **Warehouse**: Process Order, Stock Adjustment, Quality Check
- **Delivery**: Mark Delivery, Collect Payment, Report Issue
- **Accounts**: Record Payment, Add Expense, Reconcile

#### **My Performance** (This Month)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Performance                  Nov 2025    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Visits:      45/60  (75%)               â”‚
â”‚ Sales:       â‚¹2.4L/â‚¹3L  (80%)           â”‚
â”‚ Attendance:  18/19 days  (95%)          â”‚
â”‚ Rating:      â­â­â­â­ (4.2/5)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Implementation Phases

### **Phase 1: Employee Management (Week 1-2)**
âœ… **Tasks**:
1. Update User/Employee interface with new roles
2. Enhance Masters > Users page with:
   - Department filter
   - Role-based badges
   - Employee code generation
   - Reporting hierarchy
3. Add employee details form (joining date, working hours, etc.)
4. Implement role-based permissions for each employee type
5. Create employee profile page

### **Phase 2: Attendance System (Week 3-4)**
âœ… **Tasks**:
1. Create Attendance module (`/attendance`)
2. Build attendance dashboard with stats
3. Implement manual attendance marking (admin)
4. Add calendar view for monthly attendance
5. Create leave request system:
   - Apply leave (employee)
   - Approve/reject (manager/admin)
   - Leave balance tracking
6. Attendance reports (daily, monthly)

### **Phase 3: Activity Timeline (Week 5-6)**
âœ… **Tasks**:
1. Create EmployeeActivity data structure
2. Build timeline view (`/employees/{id}/timeline`)
3. Implement activity filters (today, week, month)
4. Auto-log activities:
   - Sale created â†’ Activity
   - Purchase made â†’ Activity
   - Payment received â†’ Activity
5. Manual activity entry:
   - Customer visit log
   - Call log
   - Meeting notes
6. Daily report submission form

### **Phase 4: Worker Dashboard Enhancement (Week 7-8)**
âœ… **Tasks**:
1. Redesign worker dashboard with:
   - Check-in/Check-out widget
   - Daily task list
   - Quick action buttons (role-specific)
   - Performance metrics
2. Add mobile-friendly UI (field staff access)
3. Implement geolocation for check-in/out
4. Add activity logging from worker view
5. Daily report submission
6. Leave application form

### **Phase 5: Reporting & Analytics (Week 9-10)**
âœ… **Tasks**:
1. Employee performance reports
2. Attendance analytics (month-wise, employee-wise)
3. Activity summary reports
4. Sales rep productivity dashboard
5. Warehouse efficiency metrics
6. Export reports (PDF, Excel)

---

## Technical Implementation Details

### **Database Schema (Additional Tables)**

```sql
-- Employees (Enhanced users table)
ALTER TABLE users ADD COLUMN employee_code VARCHAR(20);
ALTER TABLE users ADD COLUMN department VARCHAR(50);
ALTER TABLE users ADD COLUMN joining_date DATE;
ALTER TABLE users ADD COLUMN reporting_to INT;
ALTER TABLE users ADD COLUMN working_hours_start TIME;
ALTER TABLE users ADD COLUMN working_hours_end TIME;
ALTER TABLE users ADD COLUMN weekly_off JSON;

-- Attendance
CREATE TABLE attendance (
  id INT PRIMARY KEY AUTO_INCREMENT,
  employee_id INT NOT NULL,
  date DATE NOT NULL,
  check_in TIME,
  check_out TIME,
  status ENUM('present', 'absent', 'half-day', 'leave', 'holiday', 'week-off'),
  work_hours DECIMAL(4,2),
  overtime DECIMAL(4,2),
  check_in_location JSON,
  check_out_location JSON,
  marked_by ENUM('self', 'admin', 'system'),
  approved_by INT,
  notes TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY unique_employee_date (employee_id, date),
  FOREIGN KEY (employee_id) REFERENCES users(id)
);

-- Leave Requests
CREATE TABLE leave_requests (
  id INT PRIMARY KEY AUTO_INCREMENT,
  employee_id INT NOT NULL,
  leave_type ENUM('sick', 'casual', 'earned', 'unpaid'),
  from_date DATE NOT NULL,
  to_date DATE NOT NULL,
  days INT,
  reason TEXT,
  status ENUM('pending', 'approved', 'rejected') DEFAULT 'pending',
  applied_on TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  approved_by INT,
  approval_date TIMESTAMP,
  rejection_reason TEXT,
  FOREIGN KEY (employee_id) REFERENCES users(id)
);

-- Leave Balance
CREATE TABLE leave_balance (
  id INT PRIMARY KEY AUTO_INCREMENT,
  employee_id INT NOT NULL,
  year INT NOT NULL,
  casual_total INT DEFAULT 12,
  casual_used INT DEFAULT 0,
  sick_total INT DEFAULT 12,
  sick_used INT DEFAULT 0,
  earned_total INT DEFAULT 15,
  earned_used INT DEFAULT 0,
  UNIQUE KEY unique_employee_year (employee_id, year),
  FOREIGN KEY (employee_id) REFERENCES users(id)
);

-- Employee Activities
CREATE TABLE employee_activities (
  id INT PRIMARY KEY AUTO_INCREMENT,
  employee_id INT NOT NULL,
  date DATE NOT NULL,
  timestamp TIMESTAMP NOT NULL,
  type ENUM('sale', 'purchase', 'delivery', 'visit', 'task', 'meeting', 'call'),
  title VARCHAR(255),
  description TEXT,
  sale_id INT,
  purchase_id INT,
  customer_id INT,
  visit_details JSON,
  delivery_details JSON,
  status ENUM('completed', 'pending', 'in-progress'),
  priority ENUM('low', 'medium', 'high'),
  location JSON,
  start_time TIME,
  end_time TIME,
  duration INT,
  attachments JSON,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (employee_id) REFERENCES users(id),
  INDEX idx_employee_date (employee_id, date),
  INDEX idx_type (type)
);

-- Daily Reports
CREATE TABLE daily_reports (
  id INT PRIMARY KEY AUTO_INCREMENT,
  employee_id INT NOT NULL,
  date DATE NOT NULL,
  total_activities INT DEFAULT 0,
  completed_tasks INT DEFAULT 0,
  pending_tasks INT DEFAULT 0,
  sales_metrics JSON,
  delivery_metrics JSON,
  warehouse_metrics JSON,
  remarks TEXT,
  submitted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY unique_employee_date (employee_id, date),
  FOREIGN KEY (employee_id) REFERENCES users(id)
);
```

---

## Key Features Summary

### **For Admin**:
âœ… Complete employee management with hierarchy
âœ… Mark attendance (manual & auto)
âœ… View employee timelines
âœ… Approve leave requests
âœ… Monitor team performance
âœ… Generate attendance reports
âœ… Track daily activities of all staff

### **For Employees/Workers**:
âœ… Check-in/Check-out with location
âœ… View own attendance & leave balance
âœ… Apply for leave
âœ… Log daily activities (visits, calls, tasks)
âœ… Submit daily reports
âœ… View own performance metrics
âœ… Task management

### **Automation**:
âœ… Auto-log activities (sales, purchases, payments)
âœ… Auto-calculate work hours
âœ… Auto-mark week-offs & holidays
âœ… Attendance reminders
âœ… Leave balance auto-deduction
âœ… Performance calculation

---

## Success Metrics

1. **Reduced Manual Work**: 70% reduction in attendance tracking time
2. **Better Visibility**: Real-time view of who's doing what
3. **Improved Accountability**: Clear activity logs for each employee
4. **Data-Driven Decisions**: Performance metrics for appraisals
5. **Compliance**: Proper attendance records for labor law compliance

---

## Next Steps

1. **Review & Approve** this plan
2. **Prioritize features** (MVP vs Future)
3. **Start with Phase 1** (Enhanced Employee Management)
4. **Iterate based on feedback**

---

**Document Version**: 1.0  
**Date**: November 21, 2025  
**Status**: ðŸ“‹ Planning Phase - Awaiting Approval
